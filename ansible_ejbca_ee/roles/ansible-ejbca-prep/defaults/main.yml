---
# defaults file for primekeyprep

ejbca_root_dir: /opt
ejbca_home: "{{ ejbca_root_dir }}/ejbca"
wildfly_install_dir: /opt
wildfly_home: "{{ wildfly_install_dir }}/wildfly"
wildfly_manage_service: true

ejbca_src_link_dir: "{{  ejbca_root_dir }}/ejbca"

organizationName: Solitude
organizationNameShort: "{{ organizationName }}"
organizationDomainName: solitude.skyrim

ejbca_jdbc_driver: https://downloads.mariadb.com/Connectors/java/connector-java-2.7.0/mariadb-java-client-2.7.0.jar
ejbca_jdbc_gen_name: "{{ appsrv_datasources[0].database_jar_filename }}"

ant_version: apache-ant-1.10.9-bin.tar.gz
ant_url: "https://mirror.olnevhost.net/pub/apache/ant/binaries/{{ ant_version }}"
ant_checksum: sha256:5f8a85ddee6effe79163aa54c7bef6b60305e37200dedc1986437fb5c072a9f3

wildfly_standalone_file: standalone-22.xml.datasource.j2
wildfly_disable_infinispan: true

ejbca_manage_user: true
ejbca_group: wildfly
ejbca_user: wildfly
ejbca_user_profile: "/home/{{ ejbca_user }}"

# Location to write the CRL files on server
ejbca_crl_dir_enabled: false
ejbca_crl_dir:
  - /opt/web/CRLs
  - /opt/web/AIA

# EJBCA audit log database protection configurations
# slot_index: Index of HSM slot used for database integrity protection
# key_label: Label of key used for database integrity protection
# signature_algorithm: Algorithm used to sign database rows
# token_pin: PIN used to access HSM slot. Should be encrypted with Ansible vault
ejbca_databaseprotection:
  slot_label: DB_Protect_SLOT
  key_label: dbProtect0001
  signature_algorithm: SHA256WithRSA
  token_pin: "{{ encrypted_databaseprotection_token_pin | default('foo123') }}"
  hsm_shared_library: /usr/lib64/libsofthsm2.so

# EJBCA CA property files
ejbca_templated_properties_files:
  - src: cesecore.properties.j2
    dest: "{{ ejbca_home }}/../ejbca-custom/conf/cesecore.properties"
  - src: database.properties.j2
    dest: "{{ ejbca_home }}/../ejbca-custom/conf/database.properties"
  - src: ejbca.properties.j2
    dest: "{{ ejbca_home }}/../ejbca-custom/conf/ejbca.properties"
  - src: install.properties.j2
    dest: "{{ ejbca_home }}/../ejbca-custom/conf/install.properties"
  - src: web.properties.j2
    dest: "{{ ejbca_home }}/../ejbca-custom/conf/web.properties"
  - src: mail.properties.j2
    dest: "{{ ejbca_home }}/../ejbca-custom/conf/mail.properties"
  - src: databaseprotection.properties.j2
    dest: "{{ ejbca_home }}/../ejbca-custom/conf/databaseprotection.properties"
  - src: custom.properties.j2
    dest: "{{ ejbca_home }}/conf/custom.properties"

ejbca_force_build_ear: false

# EJBCA statedump utility source package ZIP file
ejbca_statedump_src: 

# If the statedump utility should be built into EJBCA
ejbca_build_statedump: false
# If the configdump utility should be built into EJBCA
ejbca_build_configdump: false

appsrv_datasources:
  - jndi_name: "java:/EjbcaDS"
    pool_name: ejbcads
    database_type: mariadb
    database_driver_class: org.mariadb.jdbc.Driver
    database_jar_filename: mariadb-java-client.jar
    host: 127.0.0.1
    port: 3306
    database: ejbca
    user: ejbca-usr
    credential_ref: dbPassword
    password: "{{ encrypted_database_ejbcauser_password | default('ejbca') }}"

# Uncomment to configure Wildfly to send logs to a Syslog server 
#appsrv_syslogsources:
#  - name: SYSLOGTCP
#    enabled: true
#    log_level: INFO
#    ejbca_host: my.host
#    syslog_app_name: WildFly
#    syslog_server_address: my.graylog.server
#    syslog_server_port: 514
#    syslog_facility: local-use-1

#ejbca.properties
ejbca_appserver_home: "{{ wildfly_home }}"
ejbca_productionmode: false
ejbca_allow_external_dynamic_configuration: true
# Password used to protect CMS keystores in the database (CAs CMS signer/enc certificate).
ejbca_ca_cmskeystorepass: "{{ encrypted_ejbca_ca_cmskeystorepass | default('ejbca') }}"
ejbca_cli_defaultusername: ejbca
ejbca_cli_defaultpassword: "{{ encrypted_ejbca_cli_password | default('ejbca') }}"

#cesecore.properties
core_allow_external_dynamic_configuration: true
core_ca_serialnumberoctetsize: 20
core_db_keepjbossserialization: false
core_db_keepinternalcakeystores: false
core_ca_keepocspextendedservice: false

#database.properties
ejbca_db_database_useSeparateCertificateTable: true

#mail.properties
mail_from: "ejbca-donotreply@{{ organizationDomainName }}" 

#web.properties
web_httpserver_external_privhttps: 443
web_selfreg_enabled: false
web_reqcertindb: true

# Elytron password file location
wildfly_elytron_pass_dir: /opt/elytron
wildfly_elytron_pass_file: "{{ wildfly_elytron_pass_dir }}/wildfly_pass"